{# 文章列表 #}


{% extends 'app_blog/base_blog.html' %}
{% load static %}
{{% load blog_tags %}
{% load gallery_tags %}
{% load humanize %}


<!-- Start Home -->
{% block home %}
<h2 class="title">浩瀚星海</h2>
{% if page_type %}
<h4 style="color: white;">{{ page_type }}: {{tag_name}}</h4>
<p>共 {{ page_obj.paginator.count }} 篇 </p>
{% elif keyword %}
<h4>搜索关键词:"{{ keyword }}"</h4>
<p>搜索到 {{ page_obj.paginator.count }} 条记录。</p>
{% else %}
<h4 style="color: white;">所有文章</h4>
<p>博客共有 {{ page_obj.paginator.count }} 篇 </p>
{% endif %}
{% endblock home %}


{% block blog_content_main %}

<!-- 轮播图 -->
<div id="focusslide" class="carousel slide" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#focusslide" data-slide-to="0" class="active"></li>
        <li data-target="#focusslide" data-slide-to="1"></li>
        <li data-target="#focusslide" data-slide-to="2"></li>
    </ol>
    <div class="carousel-inner" role="listbox">
        <div class="item active">
            <a href="#0" target="_blank">
                <div class="carousel-caption" style="top: 0;">标题1</div>
                <img src="data:image/png;base64,{% get_random_background 4  %}" alt="" class="img-responsive">
            </a>
        </div>
        <div class="item">
            <a href="#1" target="_blank">
                <div class="carousel-caption" style="top: 0;">标题2</div>
                <img src="data:image/png;base64,{% get_random_background 4 %}" alt="" class="img-responsive">
            </a>
        </div>
        <div class="item">
            <a href="#2" target="_blank">
                <div class="carousel-caption" style="top: 0;">标题3</div>
                <img src="data:image/png;base64,{% get_random_background 4 %}" alt="" class="img-responsive">
            </a>
        </div>
    </div>
    <a class="left carousel-control" href="#focusslide" role="button" data-slide="prev" rel="nofollow">
        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
        <span class="sr-only">上一个</span>
    </a>
    <a class="right carousel-control" href="#focusslide" role="button" data-slide="next" rel="nofollow">
        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
        <span class="sr-only">下一个</span>
    </a>
</div>

<article class="excerpt-minic excerpt-minic-index">
    <h2><span class="red">【今日推荐】</span><a href="" title="">从下载看我们该如何做事</a></h2>
    <p class="note">
        一次我下载几部电影，发现如果同时下载多部要等上几个小时，然后我把最想看的做个先后排序，
        去设置同时只能下载一部，结果是不到一杯茶功夫我就能看到最想看的电影。这就像我们一段时间
        内想干成很多事情，是同时干还是有选择有顺序的干，结果很不一样。同时...
    </p>
</article>

<div class="title">
    <h3>最新发布</h3>
    <div class="more">
        <a href="">PHP</a>
        <a href="">JavaScript</a>
        <a href="">EmpireCMS</a>
        <a href="">Apache</a>
        <a href="">MySQL</a>
    </div>
</div>

{% for article in page_obj %}
<article class="excerpt excerpt-{{ forloop.counter }}">
    <a class="focus" href="{{ article.get_absolute_url }}" title="{{ article.title }}">
        <img class="thumb" data-original="images/excerpt.jpg" src="images/excerpt.jpg" alt="">
    </a>
    <header>
        <a class="cat" href="{% url 'app_blog:category_detail' article.category.slug %}" rel="category tag">{{ article.category }}<i></i></a>
        <h2><a href="{{ article.get_absolute_url }}" title="{{ article.title }}">{{article.title}}</a></h2>
    </header>
    <p class="meta">
        <a class="time" href="{% url 'app_blog:article_list_by_author' article.author %}"><i
                class="glyphicon glyphicon-user"></i>{{article.author}}</a>
        <time class="time"><i class="glyphicon glyphicon-time"></i>{% format_time article.pub_time "%Y-%m-%d %H:%M" %}</time>
        <span class="views"><i class="glyphicon glyphicon-eye-open"></i> {{ article.views }} views</span>
        <span class="views"><i class="glyphicon glyphicon-heart"></i> {{ article.users_like.count }} likes</span>

        {% with article.tags.all as tags%}
        {% if tags %}
        <span class="views">
            <i class="glyphicon glyphicon-tag"></i>
            {% for tag in tags %}
            <a href="{% url 'app_blog:article_list_by_tag' tag.slug %}">
                {{ tag.name }}
            </a>
            {% if not forloop.last %},{% endif %}
            {% endfor %}
        </span>
        {% endif %}
        {% endwith %}

        {% if request.user == article.author or request.user.is_superuser %}
        <a class="comment" href="{% url 'app_admin:update_article' article.id article.slug %}">
            <i class="glyphicon glyphicon-pencil"></i>修改</a>
        <a class="comment" href="{{ article.get_admin_url }}">
            <i class="glyphicon glyphicon-pencil"></i>admin中编辑</a>
        {% endif %}
    </p>
    <p class="note">
        {% comment %} {{ article.body|truncatewords:10|linebreaks }} {% endcomment %}
        {% comment %} {{ article.body|markdown:10|linebreaks }} {% endcomment %}
        {{ article.body|truncatewords_html:10 }}
    </p>
</article>
{% endfor %}


<nav class="pagination" style="display: block;">
    {# 从 paginator.html 引入分页模板 #}
    {% include 'pagination.html' with page_obj=page_obj %}
</nav>


{% endblock blog_content_main %}